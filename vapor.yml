id: 44015
name: HASP
environments:
  ecommerce-branch:
    domain:
      - staging-ecommerce.haspcms-1.com
    cache: hasp-cache
    memory: 1024
    cli-memory: 512
    runtime: 'php-8.2:al2'
    build:
      - 'COMPOSER_MIRROR_PATH_REPOS=1 composer install --no-dev'
      - 'php artisan event:cache'
      - 'npm ci && npm run build && rm -rf node_modules'
  production:
    domain:
      - haspcms.net
      - "*.haspcms.net"
    timeout: 60
    warm: 10
    cache: hasp-cache
    memory: 2048
    cli-memory: 512
    cli-timeout: 900 # max allowed, 15 minutes
    runtime: 'php-8.2:al2'
    build:
      - "composer install --no-dev"
      - "php artisan event:cache"
      # - 'npm ci && npm run build && rm -rf node_modules'
    firewall:
      rate-limit: 1500
  staging:
    domain:
      - haspcms-1.com
      - "*.haspcms-1.com"
    cache: hasp-cache
    memory: 2048
    cli-memory: 512
    timeout: 60
    cli-timeout: 900 # max allowed, 15 minutes
    runtime: 'php-8.2:al2'
    build:
      - 'COMPOSER_MIRROR_PATH_REPOS=1 composer install --no-dev'
      - "php artisan event:cache"
      # - 'npm ci && npm run build && rm -rf node_modules'
    firewall:
      rate-limit: 1500
ignore:
    - node_modules
    - public/storage
    - resources/assets
    - storage
    - tests
    - build
